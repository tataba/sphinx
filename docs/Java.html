

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.开发前必读 &mdash; TaDoc 0.6.0 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/my.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="prev" title="Hello, markdown" href="markdown.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TaDoc
          

          
          </a>

          
            
            
              <div class="version">
                0.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contents.html">This is contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Hello, markdown</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">1.开发前必读</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">1.1 控制器型号选择</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">1.2 关于动态区</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">1.3 准备工作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">1.4 常见问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id6">2. 接口说明</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sdk">2.1 SDK初始化</a></li>
<li class="toctree-l2"><a class="reference internal" href="#screen">2.2 Screen类</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">2.3 屏幕连接</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">2.4 屏幕控制</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">2.5 节目与区域</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id10">2.6 动态区</a></li>
<li class="toctree-l2"><a class="reference internal" href="#server-gprs">2.7 Server模式（包含GPRS）</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TaDoc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>1.开发前必读</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Java.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>1.开发前必读<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="section" id="id2">
<h2>1.1 控制器型号选择<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>本说明只适用于BX系列五代六代控制卡（不包括字库卡），例如：BX-5E1、BX-5M1、BX-6E1X等，其中BX-5E1、BX-5E2、BX-5E3支持动态区（4个），BX-6E1、BX-6E2、BX-6E1X、BX-6E2X、BX-6Q系列支持动态区（32个）。</p>
</div>
<div class="section" id="id3">
<h2>1.2 关于动态区<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>根据存储介质的不同，我们将控制器上现实的内容分为两类：普通节目（数据存储在flash中）和动态区（数据存储在ram中）。普通节目可以包括各种区域：时间区、传感器区、图文区等。</p>
<p>普通节目，会被存储在控制器的flash中，其内容掉电不丢失，但是因为flash存储器擦写寿命只有十万次，所以，其不能用于更新频率很高的场合，例如：停车场车位信息，外部传感器状态的实时更新，车次状态的实时更新等。</p>
<p>动态区完全独立于普通节目，其内容可以按区域进行单独更新，它可以与普通节目一起播放，也可以单独播放，它最大的特点是内容存储在ram中，没有擦写次数限制，内容掉电不保存，通常用于信息更新频繁场合。</p>
</div>
<div class="section" id="id4">
<h2>1.3 准备工作<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>在进行开发之前，请使用通用软件LedshowTW图文编辑软件对控制器进行相关配置，比如控制器IP地址（串口号）、屏幕参数、扫描方式等，在使用LedshowTW软件能发送普通节目到控制器兵能显示正常后，在进行二次开发。</p>
</div>
<div class="section" id="id5">
<h2>1.4 常见问题<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>关于表格 控制器不支持Excel或其他表格，所以，需要将表格转换成图片添加到区域中</p></li>
</ul>
</div>
</div>
<div class="section" id="id6">
<h1>2. 接口说明<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h1>
<div class="section" id="sdk">
<h2>2.1 SDK初始化<a class="headerlink" href="#sdk" title="永久链接至标题">¶</a></h2>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 五代控制器</span>
<span class="c1">// 初始化SDK</span>
<span class="c1">// 初始化有3种方法，如下</span>
<span class="n">Bx5GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">();</span>

<span class="n">Bx5GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">(</span><span class="s">&quot;log.properties&quot;</span><span class="p">);</span> <span class="c1">// log.properties是日志配置文件</span>

<span class="n">Bx6GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">(</span><span class="s">&quot;log.properties&quot;</span><span class="p">,</span><span class="mi">30000</span><span class="p">);</span><span class="c1">// 30000为通讯超时时间，单位是毫秒</span>

<span class="c1">// 六代控制卡</span>
<span class="c1">// 初始化SDK</span>
<span class="c1">// 初始化有3种方法，如下</span>
<span class="n">Bx6GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">();</span>

<span class="n">Bx6GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">(</span><span class="s">&quot;log.properties&quot;</span><span class="p">);</span><span class="c1">// log.properties是日志配置文件</span>

<span class="n">Bx6GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">(</span><span class="s">&quot;log.properties&quot;</span><span class="p">,</span><span class="mi">30000</span><span class="p">);</span><span class="c1">// 30000为通讯超时时间，单位是毫秒</span>
</pre></div>
</div>
</div>
<div class="section" id="screen">
<h2>2.2 Screen类<a class="headerlink" href="#screen" title="永久链接至标题">¶</a></h2>
<p>与控制器的所有交互都需要通过Bx5GScreen类或其子类来进行，其子类包括：
Bx5GScreenClient（客户端模式使用），Bx5GScreenRS（串口模式使用），Bx5GScreenServer（服务器模式使用）。
创建screen对象的通常代码如下：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 五代控制器</span>
<span class="c1">// 创建screen对象，用于对控制器进行访问，客户端模式</span>
<span class="n">Bx5GScreenClient</span> <span class="n">screen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bx5GScreenClient</span><span class="p">(</span><span class="s">&quot;MyScreen&quot;</span><span class="p">);</span>
<span class="c1">// 创建screen对象，用于对控制器进行访问，串口模式</span>
<span class="n">Bx5GScreenRS</span> <span class="n">screen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bx5GScreenRS</span><span class="p">(</span><span class="s">&quot;MyScreen&quot;</span><span class="p">);</span>

<span class="c1">// 六代控制器创建screen对象方法，以BX-6M系列为例</span>
<span class="c1">// Bx6M 为控制卡型号，只有型号对应才能通讯正常，否则会出现逾时未回应</span>
<span class="c1">// 如果使用的控制器型号在SDK中没有定义，则用Bx6M替代</span>
<span class="c1">// 创建screen对象，用于对控制器进行访问，客户端模式</span>
<span class="n">Bx6GScreenClient</span> <span class="n">screen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bx6GScreenClient</span><span class="p">(</span><span class="s">&quot;MyScreen&quot;</span><span class="p">,</span><span class="k">new</span> <span class="n">Bx6M</span><span class="p">());</span>
<span class="c1">// 创建screen对象，用于对控制器进行访问，串口模式</span>
<span class="n">Bx6GScreenRS</span> <span class="n">screen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bx6GScreenRS</span><span class="p">(</span><span class="s">&quot;MyScreen&quot;</span><span class="p">,</span><span class="k">new</span> <span class="n">Bx6M</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>2.3 屏幕连接<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<p>在对控制器交互之前，需要先与控制器建立连接，代码如下：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 连接控制器</span>
<span class="c1">// 其中，192.168.100.199为控制器的实际IP地址，请根据实际情况填写</span>
<span class="c1">// 如果不知道控制器IP地址，请先使用LedshowTW软件设置IP地址，软件下载地址：https://www.onbonbx.com/download/165.html</span>
<span class="c1">// 端口号默认为5005</span>
<span class="c1">// 五代控制器和六代控制器屏幕连接方法一样</span>
<span class="n">screen</span><span class="p">.</span><span class="na">connect</span><span class="p">(</span><span class="s">&quot;192.168.100.199&quot;</span><span class="p">,</span><span class="mi">5005</span><span class="p">);</span>
</pre></div>
</div>
<p>与控制器交互完成后，需断开与控制器之间的连接，其代码如下：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 断开与控制器之间的连接</span>
<span class="n">screen</span><span class="p">.</span><span class="na">disconnect</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h2>2.4 屏幕控制<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 以下为一些简单控制命令的使用方法</span>
<span class="c1">// 开关机命令</span>
<span class="n">screen</span><span class="p">.</span><span class="na">turnOff</span><span class="p">();</span><span class="c1">// 关机</span>
<span class="n">screen</span><span class="p">.</span><span class="na">turnOn</span><span class="p">();</span><span class="c1">// 开机</span>
<span class="n">screen</span><span class="p">.</span><span class="na">syncTime</span><span class="p">();</span><span class="c1">// 校时</span>
<span class="n">screen</span><span class="p">.</span><span class="na">ping</span><span class="p">();</span><span class="c1">// ping命令</span>
<span class="c1">// 查询控制器状态</span>
<span class="n">screen</span><span class="p">.</span><span class="na">checkControllerStatus</span><span class="p">();</span>
<span class="c1">// 查询控制器当前固件版本</span>
<span class="n">screen</span><span class="p">.</span><span class="na">checkFirmware</span><span class="p">();</span>
<span class="c1">// 查询控制器内存</span>
<span class="n">screen</span><span class="p">.</span><span class="na">checkMemVolumes</span><span class="p">();</span>
<span class="c1">// 锁定屏幕当前画面</span>
<span class="n">screen</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span>
<span class="c1">// 解除锁定屏幕当前画面</span>
<span class="n">screen</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="c1">// 通过以下接口回读控制器状态</span>
<span class="n">Bx5GScreen</span><span class="p">.</span><span class="na">Result</span><span class="o">&lt;</span><span class="n">ReturnControllersStatus</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">screen</span><span class="p">.</span><span class="na">checkControllerStatua</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">isOK</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">ReturnControllerStatus</span> <span class="n">status</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="na">reply</span><span class="p">;</span>
    <span class="n">status</span><span class="p">.</span><span class="na">getBrightness</span><span class="p">();</span><span class="c1">// 取得亮度值</span>
    <span class="n">status</span><span class="p">.</span><span class="na">getTemperature1</span><span class="p">();</span><span class="c1">// 取得温度传感器温度值</span>
    <span class="c1">// status还有很多接口，根据实际应用进行调用</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="n">ErrorType</span> <span class="n">error</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="na">getError</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h2>2.5 节目与区域<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h2>
<p>节目主要用于组合屏幕上现实的内容，它由多个区域组成。控制器同一时间只能播放一个集美，它是控制器现实内容可以单独更新的最小单位。
以下，我们将按步骤创建一个节目，并将其发送到控制器进行显示</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 创建节目文件</span>
<span class="c1">// 第二个参数为显示屏属性，具体可以参照Bx5GScreenProfile类</span>
<span class="n">Bx5GScreenProfile</span> <span class="n">profile</span> <span class="o">=</span> <span class="n">screen</span><span class="p">.</span><span class="na">getProfile</span><span class="p">();</span>
<span class="n">ProgramBxFile</span> <span class="n">p0</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ProgramBxFile</span><span class="p">(</span><span class="s">&quot;P000&quot;</span><span class="p">,</span><span class="n">profile</span><span class="p">);</span>
<span class="c1">// 关于节目类的其他接口可以参考ProgramBxFile类</span>
</pre></div>
</div>
<p>控制器支持的区域有很多种，例如：图文区、时间区、传感器区等。其中，最常用的是图文区。图文区可以支持显示文本和图片，文字或图片可以按数据也依次添加到图文区中，每页数据均可以设置特技方式，停留时间等属性
创建图文区的步骤大致如下：
创建TextCaptionBxArea对象
创建TextBxPage或ImageFileBxPage对象
将创建好的page对象添加到TextCaptionBxArea中
如下代码，创建一个文本区，并向这个区域中添加一个文本页</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 创建一个图文区</span>
<span class="c1">// 参数为X、Y、width、heigth</span>
<span class="c1">// 注意区域左边和宽度高度，不要越界</span>
<span class="n">TextCaptionBxArea</span> <span class="n">area</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextCaptionBxArea</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">64</span><span class="p">);</span>
<span class="c1">// 创建一个数据页，并希望显示“仰邦科技”这几个字</span>
<span class="n">TextBxPage</span> <span class="n">page</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextBxPage</span><span class="p">(</span><span class="s">&quot;仰邦科技&quot;</span><span class="p">);</span>
<span class="c1">// 将page添加到area中</span>
<span class="n">area</span><span class="p">.</span><span class="na">addPage</span><span class="p">(</span><span class="n">page</span><span class="p">);</span>
<span class="c1">// 将图文区添加到节目中</span>
<span class="n">p0</span><span class="p">.</span><span class="na">addArea</span><span class="p">(</span><span class="n">area</span><span class="p">);</span>
</pre></div>
</div>
<p>关于时间区
时间区的创建过程大致如下：
创建DateTimeBxArea对象
设置各时间单元显示格式
将DateTimeBxArea添加到节目中</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 下面代码创建了一个时间区</span>
<span class="c1">// 注意：只需输入时间区的起始坐标，区域的宽度和高度SDK会根据字体和显示方式自动计算</span>
<span class="n">DateTimeBxArea</span> <span class="n">dtArea</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTimeBxArea</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">screen</span><span class="p">.</span><span class="na">getProfile</span><span class="p">());</span>
<span class="c1">// 设置字体</span>
<span class="n">dtArea</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span> <span class="n">Font</span><span class="p">(</span><span class="s">&quot;宋体&quot;</span><span class="p">,</span><span class="n">Font</span><span class="p">.</span><span class="na">PLAIN</span><span class="p">,</span><span class="mi">12</span><span class="p">));</span>
<span class="c1">// 设置显示颜色</span>
<span class="n">dtArea</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">yellow</span><span class="p">);</span>
<span class="c1">// 多行显示还是单行显示</span>
<span class="n">dtArea</span><span class="p">.</span><span class="na">setMultiline</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="c1">// 年月日显示格式</span>
<span class="c1">// 如果不需要显示，设置为null</span>
<span class="n">dtArea</span><span class="p">.</span><span class="na">setDateStyle</span><span class="p">(</span><span class="n">DateStyle</span><span class="p">.</span><span class="na">YYY_MM_DD_1</span><span class="p">);</span>
<span class="n">dtArea</span><span class="p">.</span><span class="na">setTimeStyle</span><span class="p">(</span><span class="n">TimeStyle</span><span class="p">.</span><span class="na">HH_MM_SS_1</span><span class="p">);</span>
<span class="n">dtArea</span><span class="p">.</span><span class="na">setWeekStyle</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="c1">// 将时间区添加到节目中</span>
<span class="n">p0</span><span class="p">.</span><span class="na">addArea</span><span class="p">(</span><span class="n">dtArea</span><span class="p">);</span>
<span class="c1">// 关于DateTimeBxArea类的更多接口，请参考JAVADOC中相关类的说明</span>
</pre></div>
</div>
<p>更新节目</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 以下为更新节目命令</span>
<span class="n">screen</span><span class="p">.</span><span class="na">WriteProgram</span><span class="p">(</span><span class="n">p0</span><span class="p">);</span>
<span class="c1">// 更新节目还有很多命令，请参考JAVADOC</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h2>2.6 动态区<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h2>
<p>动态区是一种比较特殊的区域，其有以下几个主要特点：</p>
<ul class="simple">
<li><p>更新次数没有限制</p></li>
<li><p>内容掉电不保存</p></li>
<li><p>独立于节目进行编辑</p></li>
<li><p>可以支持多个区域，且每个区域可以进行单独更新</p></li>
<li><p>可以和单个活多个节目绑定显示，即作为节目的一个区域进行显示</p></li>
<li><p>可以作为单独一个节目进行独立播放</p></li>
<li><p>灵活的控制方式：超时时间控制、是否立即显示灯</p></li>
</ul>
<p>以下为动态区代码</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// 五代控制器动态区（BX-5E系列）
// BX-5E系列控制卡最高支持4个动态区，当屏幕上需要同时显示多个动态区时，动态区ID不可以相同
// DynamicBxRule(id,runMode,immediatePlay,timeout);
// runMode 运行模式
// 0:循环显示
// 1:显示完成后静止显示最后一页数据
// 2:循环显示，超过设定时间后数据仍未更新时不显示
// 3:循环显示，超过设定时间后数据仍未更新时显示Logo信息
// 4:循环显示，显示完最后一页后不再显示
// immediatePlay
// 0:与异步节目一起播放
// 1:异步节目停止播放，仅播放动态区
// 2:当播放完节目编号最高的异步节目后播放该动态区
DynamicBxAreaRule rule = new DynamicBxRule(0,(byte)0,(byte)1,0);
TextCaptionBxArea darea = new TextCaptionBxArea(0,0,160,64,screen.getProfile());
TextBxPage dapge = new TextBxPage(&quot;动态区123abc&quot;);
darea.addPage(dpage);
screen.writeDynamic(rule,darea);

// 六代控制器动态区
DynamicBxAreaRule rule = new DynamicBxAreaRule();
// 设定动态区ID，此处ID为0，多个动态区ID不能相同
rule.setId(0);
// 设定异步节目停止播放，仅播放动态区
// 0:动态区与异步节目一起播放
// 1:异步节目停止播放，仅播放动态区
// 2:当播放完节目编号最高的异步节目后播放该动态区
rule.setImmediatePlay((byte)1);
// 设定动态区循环播放
// 0:循环播放
// 1:显示完成后静置显示最后一页数据
// 2:循环显示，超过设定时间后仍未更新时不再显示
// 3:循环显示，超过设定时间后仍未更新时显示Logo信息
// 4:显示完成最后一页后就不再显示
rule.setRunMode((byte)0);
DynamicBxArea area = new DynamicBxArea(0,0,160,32,screen.getProfile());
TextBxPage page = new TextBxPage(&quot;动态区abc&quot;);
area.addPage(page);
screen.writeDynamic(rule,area);
</pre></div>
</div>
</div>
<div class="section" id="server-gprs">
<h2>2.7 Server模式（包含GPRS）<a class="headerlink" href="#server-gprs" title="永久链接至标题">¶</a></h2>
<p>Server使用流程如下：</p>
<ul class="simple">
<li><p>初始化API（在一个进程内只需要初始化一次）</p></li>
<li><p>建立服务器</p></li>
<li><p>设定监听等待屏幕的连线与断线事件</p></li>
<li><p>关闭服务器</p></li>
</ul>
<p>主要代码如下：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Bx5GEnv</span><span class="p">.</span><span class="na">initial</span><span class="p">();</span> <span class="c1">//初始化</span>
<span class="c1">// 建立服务器</span>
<span class="n">Bx5GServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bx5GServer</span><span class="p">(</span><span class="s">&quot;Hello Screen&quot;</span><span class="p">,</span> <span class="mi">8036</span><span class="p">);</span>
<span class="c1">// 添加监听</span>
<span class="n">server</span><span class="p">.</span><span class="na">addListener</span><span class="p">(</span><span class="k">new</span> <span class="n">ConnectionListener</span><span class="p">());</span>
<span class="c1">// 启动服务器</span>
<span class="n">server</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;waiting 30 secs&quot;</span><span class="p">);</span>
<span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">30000</span><span class="p">);</span>
<span class="c1">// 更新节目或者动态区</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">//</span>


<span class="c1">// 关闭服务器</span>
<span class="n">server</span><span class="p">.</span><span class="na">stop</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;done!&quot;</span><span class="p">);</span>

<span class="c1">// 监听</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConnectionListener</span> <span class="kd">implements</span> <span class="n">Bx5GServerListener</span> <span class="p">{</span>
<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">connected</span><span class="p">(</span><span class="n">String</span> <span class="n">socketId</span><span class="p">,</span> <span class="n">String</span> <span class="n">controllerAddr</span><span class="p">,</span>
<span class="n">Bx5GScreen</span> <span class="n">screen</span><span class="p">)</span> <span class="p">{</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">ReturnPingStatus</span><span class="o">&gt;</span> <span class="n">result1</span> <span class="o">=</span> <span class="n">screen</span><span class="p">.</span><span class="na">ping</span><span class="p">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">ReturnControllerStatus</span><span class="o">&gt;</span> <span class="n">result2</span> <span class="o">=</span>
<span class="n">screen</span><span class="p">.</span><span class="na">checkControllerStatus</span><span class="p">();</span>
<span class="p">...</span>
<span class="p">}</span>
<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">disconnected</span><span class="p">(</span><span class="n">String</span> <span class="n">socketId</span><span class="p">,</span> <span class="n">String</span> <span class="n">controllerAddr</span><span class="p">,</span>
<span class="n">Bx5GScreen</span> <span class="n">screen</span><span class="p">)</span> <span class="p">{</span>
<span class="p">...</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="markdown.html" class="btn btn-neutral float-left" title="Hello, markdown" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright onbon

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>